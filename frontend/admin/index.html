{% extends "admin/index.html" %}
{% load i18n static %}

{% block content %}
<div id="content-main" class="dashboard">
  
  <!-- QUICK STATS SECTION -->
  <div class="quick-stats" style="display: flex; gap: 20px; margin-bottom: 30px;">
      <div class="stat-card glass-card" style="flex: 1; padding: 20px; text-align: center;">
          <i class="fas fa-users" style="font-size: 2rem; color: var(--accent-primary); margin-bottom: 10px;"></i>
          <h3 style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; text-transform: uppercase;">Total Users</h3>
          <p style="margin: 5px 0 0; font-size: 1.8rem; font-weight: 700; color: white;">Active</p>
      </div>
      <div class="stat-card glass-card" style="flex: 1; padding: 20px; text-align: center;">
          <i class="fas fa-utensils" style="font-size: 2rem; color: #2ecc71; margin-bottom: 10px;"></i>
          <h3 style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; text-transform: uppercase;">Restaurants</h3>
          <p style="margin: 5px 0 0; font-size: 1.8rem; font-weight: 700; color: white;">Partners</p>
      </div>
      <div class="stat-card glass-card" style="flex: 1; padding: 20px; text-align: center;">
          <i class="fas fa-shopping-bag" style="font-size: 2rem; color: #3498db; margin-bottom: 10px;"></i>
          <h3 style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; text-transform: uppercase;">Orders</h3>
          <p style="margin: 5px 0 0; font-size: 1.8rem; font-weight: 700; color: white;">Managed</p>
      </div>
  </div>

  {% if app_list %}
    <div class="glow-bg top-left" style="opacity: 0.3;"></div>
    <div class="glow-bg bottom-right" style="opacity: 0.3;"></div>

    <div class="dashboard-grid">
        <!-- App List Column -->
        <div class="app-list">
            {% for app in app_list %}
            <div class="module glass-card app-{{ app.app_label }}">
                <table style="width: 100%;">
                <caption style="text-align: left; padding: 15px;">
                    <a href="{{ app.app_url }}" class="section" title="{% blocktranslate with name=app.name %}Models in the {{ name }} application{% endblocktranslate %}">{{ app.name }}</a>
                </caption>
                {% for model in app.models %}
                    <tr class="model-{{ model.object_name|lower }}{% if model.admin_url in request.path %} current-model{% endif %}">
                    {% if model.admin_url %}
                        <th scope="row"><a href="{{ model.admin_url }}" style="font-weight: 600;">{{ model.name }}</a></th>
                    {% else %}
                        <th scope="row">{{ model.name }}</th>
                    {% endif %}

                    {% if model.add_url %}
                        <td><a href="{{ model.add_url }}" class="addlink"><i class="fas fa-plus"></i> {% translate 'Add' %}</a></td>
                    {% else %}
                        <td></td>
                    {% endif %}

                    {% if model.admin_url %}
                        {% if model.view_only %}
                        <td><a href="{{ model.admin_url }}" class="viewlink">{% translate 'View' %}</a></td>
                        {% else %}
                        <td><a href="{{ model.admin_url }}" class="changelink"><i class="fas fa-edit"></i> {% translate 'Change' %}</a></td>
                        {% endif %}
                    {% else %}
                        <td></td>
                    {% endif %}
                    </tr>
                {% endfor %}
                </table>
            </div>
            {% endfor %}
        </div>

        <!-- Sidebar Column -->
        <div class="dashboard-sidebar">
            <div class="module glass-card" id="recent-actions-module">
                <h2 style="font-size: 1.1rem; margin-bottom: 20px; color: var(--accent-primary);">{% translate 'Recent actions' %}</h2>
                <div style="color: var(--text-secondary); font-size: 0.9rem;">
                    {% load log %}
                    {% get_admin_log 10 as admin_log for_user user %}
                    {% if not admin_log %}
                    <p>{% translate 'None available' %}</p>
                    {% else %}
                    <ul class="actionlist" style="list-style: none; padding: 0;">
                    {% for entry in admin_log %}
                    <li class="{% if entry.is_addition %}addlink{% endif %}{% if entry.is_change %}changelink{% endif %}{% if entry.is_deletion %}deletelink{% endif %}" style="margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid rgba(255,255,255,0.05);">
                        <span style="opacity: 0.7; font-size: 0.8rem; display: block;">
                            {% if entry.is_addition %}<i class="fas fa-plus-circle" style="color: #2ecc71;"></i>{% endif %}
                            {% if entry.is_change %}<i class="fas fa-pen" style="color: #f1c40f;"></i>{% endif %}
                            {% if entry.is_deletion %}<i class="fas fa-trash" style="color: #e74c3c;"></i>{% endif %}
                            
                            {% if entry.content_type %}
                                <span class="mini quiet">{% filter capfirst %}{{ entry.content_type }}{% endfilter %}</span>
                            {% else %}
                                <span class="mini quiet">{% translate 'Unknown content' %}</span>
                            {% endif %}
                        </span>
                        
                        <a href="{{ entry.get_admin_url }}" style="color: white !important;">{{ entry.object_repr }}</a>
                    </li>
                    {% endfor %}
                    </ul>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
  {% else %}
    <p>{% translate 'You donâ€™t have permission to view or edit anything.' %}</p>
  {% endif %}
</div>
{% endblock %}
